# Pipeline-Based Neural Network Intrusion Detection System (IDS) for IoT Networks

## Project Information
**Course:** Data Security and Analytics 
**Project Type:** Course Project  

**Developed by:**  
- Student 1: Tala Raed 
- Student 2: Yazeed Suleiman

---

## Project Presentation
A detailed visual explanation of the system design, dataset, pipeline architecture, and evaluation results is available at:

ðŸ‘‰ https://prezi.com/view/2WDORkAi3uZDGXWDRdRE/?referral_token=UIuwjrlnB3FN

---

## Project Description

This project implements a **pipeline-based Intrusion Detection System (IDS)** designed to detect **malicious network traffic in Internet of Things (IoT) environments** using a **neural network**.

IoT devices are often deployed with limited security controls and are frequent targets of **botnet-based attacks** such as Mirai and Gafgyt. These attacks can lead to large-scale Distributed Denial-of-Service (DDoS), network scanning, and service disruption.  
The goal of this project is to automatically identify such malicious behavior by learning patterns from network traffic data.

The system analyzes **statistical flow-based network features** and classifies traffic into:
- **Normal traffic**
- **Attack traffic**

---

## What the System Detects

The IDS is designed to detect **malicious IoT network behavior**, including:

- Botnet-driven flooding attacks
- Denial-of-Service (DoS / DDoS) activity
- Scanning behavior used to discover vulnerable devices
- Abnormal traffic patterns generated by compromised IoT devices

The system does **not rely on predefined signatures**. Instead, it learns attack patterns directly from data using a neural network.

---

## How the System Works (High-Level)

1. A large IoT network traffic dataset is loaded
2. The dataset is explored to understand class distribution and feature structure
3. Attack-related label columns are removed to prevent data leakage
4. The data is preprocessed (encoding and scaling)
5. A neural network is trained to distinguish normal and malicious traffic
6. The trained model is evaluated using security-relevant metrics
7. Results and models are saved for analysis and reuse

All steps are implemented as **independent pipeline stages** executed in a dependency-controlled order.

---

## Pipeline-Based Architecture

The project uses a **pipeline architecture**, meaning each step of the machine learning workflow is isolated into a separate stage.  
A central runner executes these stages only when their dependencies are satisfied.

### Pipeline Execution Flow

load_data
â†“
explore_data
â†“
build_dataset
â†“
preprocess
â†“
train
â†“
evaluate
â†“
save_artifacts


This design:
- Prevents invalid execution order
- Improves readability and maintainability
- Makes the system reproducible and extensible

---

## Project Structure

<img width="332" height="431" alt="image" src="https://github.com/user-attachments/assets/afd9acce-7c22-4635-9412-b4c5ed24cf65" />

---

## Explanation of Each File

### `main.py`
- The **only executable file**
- Defines pipeline stages and their dependencies
- Initializes configuration and shared context
- Starts the pipeline execution

---

### `pipeline/config.py`
- Stores all configuration values:
  - Dataset path
  - Column names
  - Sampling size
  - Model hyperparameters
- Centralizes experiment settings for reproducibility

---

### `pipeline/context.py`
- Acts as shared memory across pipeline stages
- Stores:
  - Raw and processed data
  - Train/test splits
  - Trained model
  - Evaluation results

---

### `pipeline/runner.py`
- Implements the pipeline execution engine
- Resolves dependencies between stages
- Ensures correct execution order

---

## Pipeline Stages

### `load_data.py`
- Loads the dataset from disk
- Initializes output directories
- Stores raw data in the shared context

---

### `explore_data.py`
- Analyzes dataset structure and size
- Displays class distribution and attack distribution
- Helps validate dataset quality

---

### `build_dataset.py`
- Removes duplicate records
- Applies stratified sampling to handle dataset size
- Creates train/test splits
- Drops attack name columns to prevent **label leakage**

---

### `preprocess.py`
- Separates numerical and categorical features
- Applies:
  - Standard scaling to numerical features
  - One-hot encoding to categorical features
- Fits preprocessing only on training data

---

### `train.py`
- Defines and trains a fully connected neural network
- Uses dropout and batch normalization for regularization
- Trains the model to classify traffic as normal or attack

---

### `evaluate.py`
- Evaluates model performance on unseen test data
- Computes:
  - Accuracy
  - Precision
  - Recall
  - F1-score
  - ROC-AUC
  - Confusion matrix
- Emphasizes false negatives due to security risk

---

### `save_artifacts.py`
- Saves all outputs to the `artifacts/` directory:
  - Metrics
  - Training history
  - Trained model

---

## Dataset Description

- Large-scale IoT network traffic dataset
- Over **7 million records**
- Flow-based statistical features
- Binary label:
  - `0` â†’ Normal traffic
  - `1` â†’ Attack traffic

To manage computational constraints, **stratified sampling** is applied.

---

## Attack Types in the Dataset

### Attack Families
- **Mirai**
  - IoT botnet exploiting weak credentials
  - Used for large-scale DDoS attacks

- **Gafgyt (Bashlite)**
  - Linux-based IoT botnet
  - Used for flooding and scanning attacks

### Attack Subtypes
- UDP Flood
- TCP Flood
- SYN Flood
- ACK Flood
- Port Scanning
- Combo Attacks
- Junk Traffic

Attack name columns are excluded from training to prevent label leakage.

---

## Neural Network Model

- Fully connected feedforward neural network
- ReLU activation functions
- Batch normalization and dropout
- Sigmoid output layer for binary classification

The architecture is suitable for **tabular IoT traffic data**.

---

## Evaluation Metrics

The system is evaluated using:
- Accuracy
- Precision
- Recall
- F1-score
- ROC-AUC
- Confusion Matrix

### Security Perspective
- **False Negatives (missed attacks)** are the most critical errors
- **Recall** is the most important metric for IDS systems

---

## Outputs

After execution, the following files are generated in the `artifacts/` directory:
- `dataset_summary.json`
- `metrics.json`
- `train_history.json`
- `ids_model.keras`

---

## How to Run the Project

```bash
pip install pandas numpy scikit-learn tensorflow
python main.py


Conclusion
This project demonstrates a modular, scalable, and security-aware Intrusion Detection System for IoT networks.
By combining a neural network with a dependency-driven pipeline architecture, the system effectively detects malicious IoT traffic while maintaining clean design and reproducibility.

Future Work
Multi-class attack classification

Real-time streaming detection

Lightweight deployment for edge IoT devices

Feature selection and optimization
